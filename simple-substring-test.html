<!DOCTYPE html>
<html>
<head>
    <title>Simple Substring Test</title>
</head>
<body>
    <h2>Simple Substring Test</h2>
    <div id="results"></div>

    <script type="module">
        import { Interpreter } from './js/interpreter.js';

        const interpreter = new Interpreter();
        const results = document.getElementById('results');

        function log(message) {
            console.log(message);
            const div = document.createElement('div');
            div.textContent = message;
            div.style.margin = '5px 0';
            div.style.fontFamily = 'monospace';
            results.appendChild(div);
        }

        // Test the simplest possible case
        log("=== Simple Case Test ===");
        
        try {
            const result = interpreter.execute(`country = "France"
x = 1
print(country.substring(x, 1))`);
            
            log(`Variables: ${JSON.stringify(result.variables)}`);
            log(`Outputs: [${result.outputs.join(', ')}]`);
            log(`Trace: ${JSON.stringify(result.trace.map(t => ({line: t.lineNumber, output: t.output, vars: t.variables})))}`);
            
        } catch (e) {
            log(`❌ Error: ${e.message}`);
        }

        // Test the executeStatement method directly
        log("\n=== Direct executeStatement Test ===");
        
        try {
            const testVars = { country: "France", x: 1 };
            const result = interpreter.executeStatement('print(country.substring(x, 1))', 1, testVars);
            
            log(`executeStatement result:`);
            log(`  output: "${result.output}"`);
            log(`  shouldTrace: ${result.shouldTrace}`);
            log(`  changedVariables: ${JSON.stringify(result.changedVariables)}`);
            
        } catch (e) {
            log(`❌ Error in executeStatement: ${e.message}`);
        }
    </script>
</body>
</html>
